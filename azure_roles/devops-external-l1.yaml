# --- EXTERNAL L1 (JUNIOR) AZURE ROLE DEFINITION ---
# Focus: Operational triage and runtime support.
# Safety: No destructive or identity-governance mutation rights.

name: "DevOps-External-L1"
description: "Junior External Contractor: Read + operational runtime actions, no delete or RBAC mutation."

actions:
  # Compute Triage
  - "Microsoft.Compute/virtualMachines/read"
  - "Microsoft.Compute/virtualMachines/start/action"
  - "Microsoft.Compute/virtualMachines/restart/action"
  - "Microsoft.Compute/virtualMachines/powerOff/action"
  - "Microsoft.Compute/virtualMachines/instanceView/read"
  - "Microsoft.Compute/virtualMachines/extensions/read"

  # Resource Visibility
  - "Microsoft.Resources/subscriptions/resourceGroups/read"
  - "Microsoft.Resources/deployments/read"
  - "Microsoft.Network/networkInterfaces/read"
  - "Microsoft.Network/loadBalancers/read"
  - "Microsoft.Network/networkSecurityGroups/read"

  # App Platform Read + Safe Config
  - "Microsoft.App/containerApps/read"
  - "Microsoft.App/containerApps/write"
  - "Microsoft.Web/sites/read"
  - "Microsoft.Web/sites/config/read"

  # API Management Read
  - "Microsoft.ApiManagement/service/read"

  # Data Plane Visibility
  - "Microsoft.Storage/storageAccounts/read"
  - "Microsoft.Storage/storageAccounts/listKeys/action"

  # Monitoring & Maintenance
  - "Microsoft.Insights/metrics/read"
  - "Microsoft.Insights/logDefinitions/read"
  - "Microsoft.Insights/diagnosticSettings/read"
  - "Microsoft.Maintenance/maintenanceConfigurations/read"
  - "Microsoft.Maintenance/applyUpdates/read"
  - "Microsoft.Maintenance/applyUpdates/write"
  - "Microsoft.Support/supportTickets/read"
  - "Microsoft.Support/supportTickets/write"

notActions:
  - "*/delete"
  - "Microsoft.Authorization/roleAssignments/write"
  - "Microsoft.Authorization/roleDefinitions/write"
  - "Microsoft.Authorization/policyAssignments/write"
  - "Microsoft.Authorization/policyDefinitions/write"

assignableScopes:
  - "/subscriptions/${var.subscription_id}"
